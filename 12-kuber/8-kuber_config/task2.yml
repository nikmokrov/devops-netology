apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-index-configmap
data:
  index.html:  |
    <!doctype html>
    <html lang="en">
      <head>
        <title>DEVOPS-22 nginx sample page</title>
      </head>
      <body>
        <h1>DEVOPS-22 nginx sample page for k8s ConfigMap lesson</h1>
      </body>
    </html>

---
apiVersion: v1
kind: Secret
metadata:
  name: nginx-tls-secret
type: tls
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZVakNDQXpxZ0F3SUJBZ0lVUE5GdGwyaWhEUGpIVklRV1BJSWw2SEd3dXh3d0RRWUpLb1pJaHZjTkFRRUwKQlFBd0dqRVlNQllHQTFVRUF3d1BibWxyYlc5cmNtOTJMbU5zYjNWa01CNFhEVEl6TURjeE9ERXlORGsxTWxvWApEVE16TURjeE5URXlORGsxTWxvd0dqRVlNQllHQTFVRUF3d1BibWxyYlc5cmNtOTJMbU5zYjNWa01JSUNJakFOCkJna3Foa2lHOXcwQkFRRUZBQU9DQWc4QU1JSUNDZ0tDQWdFQXd3eWZIN0FVY1ZMd2FoNlBObENzbEFCS3dVNW8KamJPTFBnZ2hnb0N2MmFhYi9aRUM1bGE0TDE2ZUU4ZmMxbGhWM216dTJ4QVNGaDBTYkhYazllSXl3bktWRE1OMQpaUHJUcmZNTTgxRkt5NWRuOUJTa3M3LzhWWkxQTkR2OTQrTllMYVJSWWhDa2J6YmljRVIyRDVIRGI2U3lJSjllCnczMW9hcVdhKzR3MEdDdHhJRTdpM3d3c2Z1bndQZjBIckN0ajl5Ynk1aDNMV0ZNa3hsZjQrZ2c4WE1GTnlUVmkKYmhWS0szTXZpWnlvNEZGUGJTeWdGNm02THZKaXNDZXJGck0zVzQ4eHRJQ1picldjTGZnc1dBMVlyWm0wZU8rTwpVb2NlazVGWTVJZWtTa3FrVXVKQVZ4UitmY1d4bVluMU1uTkV2anRSZno4VUMvak40cmorY09SZUVOc1NQVkZnCmJIdVV6ZDJtT3N3WWdsU01ZNDJ4Ky9ZRzIyOEpZelRjY29PVllaYnJINjY3KzVSSzVVVDMxbVhvSEdsbWFzM0gKMW9jMHRRb0xTckk0a013ZEVUYTArZWdxWlZjYlF0YWNCTDlKeFlCK2U3NnBSVEEyYmJhdkt1SVJtbGJrSHIwTwpGYzNUSm1zKzI0VDNZaEJzckQvdGxTcmM4c2VCWjhlWWRFcnlLbjExaVhxNFp2RVF5V3RsVzZzN1JZbFR1d0FrCk5PdnpKZmlOTWlRdUM4WElHRS9KbUZGc2RWR0ZwZHdVenQ4cmllM0tpcVVJVmVRRVRNOTJEcEV4eE10VzFFSU0KMHlzWmx4L2dzS3BKTnNPellrbXR3Zjl6aDA2SkErcDVzc2dDU2ZBMk1LUkk4YlRUU243RDlDR1hHdHI5MmJ6VQpGZUNpeHNhZFkyc1FnMHNDQXdFQUFhT0JqekNCakRBZEJnTlZIUTRFRmdRVXpOc1VVd2FQNUE3ZGVqTHpTcnpvCjNvK0RER293SHdZRFZSMGpCQmd3Rm9BVXpOc1VVd2FQNUE3ZGVqTHpTcnpvM28rRERHb3dEd1lEVlIwVEFRSC8KQkFVd0F3RUIvekE1QmdOVkhSRUVNakF3Z2c5dWFXdHRiMnR5YjNZdVkyeHZkV1NDRVNvdWJtbHJiVzlyY205MgpMbU5zYjNWa2h3UUtnUUFlaHdTZW9FODNNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUNBUUJkYlluK3RFU0VUNmJvCkE0dlZKOVVPRE9zS0g4YW1lQlNYZlVEblFkOWtVRStqRUpJa21mMG14ZXRodHRDVUc4VEE2c2JqSVVJRFcyOVMKRTQ0TVFQck1TQWZLWk83L2VQbm9pQ0FKVTQ2ODM3ZGhheHJEdjl0OXBSL0lrdnhhcmhOVGNoVmxHVjRxRUFUQQpZaVNzN0JJMHFLc295cFA1K1FFcUxBVFl1M3NBSTdvVUphN01ML0U5UzZoVjF0NXhnVVpmUjFHcGFzTG94Z1NLCnFFLzg5dVJhOE5Wc0htNWtpbnZGZ29sQjg3OXVqRkdlcDZtWjUvR1R5YjkxUHVzK3U1eEdxcWZJcFkxN3Nha1MKNlFGQ3hIYjdidVphNXRPdE5XN1hPYTBiekQxYU9LYmJOTEZrU0MvU3FQMXZqUWZJcWJXYWZQaHQ4ZUlWMkVsagpxVGlnUkxjUFRwaDQwMFJFYmpsV3hpSU55d0ZFbEVLVUhydUtIbTE3THlNTU8zWmpyek80WkFOaVVSZGNtMXd6CjRZTFR0M0hraExSWWl3VllsSFdhMzJxU09Kdy9IL0NJZXptdzZEV1JjK1VaQWVjaGpDN1RHYWtxZ3B3TWhYdEQKVG93UEU5MXhPSnJvaG1QTnRWeGhDM1J0cTZwMWJFV2VJQ3R0YkxqdXlTTGtIL0tlOU9CRUdCVEYwOFR0R1FVYwpSQlRPSFVyaThzUXVyWE1OMXJhUlJ1YnUyRlJEd2EzNHcyWUVzL24rVUxJSHhWZ2F3MHduRzluR2xoNkJiL0FTCnUyVUZUeDZtKzhlSkJEaUJOOFFWK1JYUTNvdWo5Vzg2M3ZRcVFaaWR6VTFjZjZDbHppekFzRTA3N2ZIa1F1dGwKd2Ywb2pHbnllNXN2eVpMekI1RDJTSU1wd3MxRVZ3PT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUpRd0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQ1Mwd2dna3BBZ0VBQW9JQ0FRRERESjhmc0JSeFV2QnEKSG84MlVLeVVBRXJCVG1pTnM0cytDQ0dDZ0svWnBwdjlrUUxtVnJndlhwNFR4OXpXV0ZYZWJPN2JFQklXSFJKcwpkZVQxNGpMQ2NwVU13M1ZrK3RPdDh3enpVVXJMbDJmMEZLU3p2L3hWa3M4ME8vM2o0MWd0cEZGaUVLUnZOdUp3ClJIWVBrY052cExJZ24xN0RmV2hxcFpyN2pEUVlLM0VnVHVMZkRDeCs2ZkE5L1Flc0syUDNKdkxtSGN0WVV5VEcKVi9qNkNEeGN3VTNKTldKdUZVb3JjeStKbktqZ1VVOXRMS0FYcWJvdThtS3dKNnNXc3pkYmp6RzBnSmx1dFp3dAorQ3hZRFZpdG1iUjQ3NDVTaHg2VGtWamtoNlJLU3FSUzRrQlhGSDU5eGJHWmlmVXljMFMrTzFGL1B4UUwrTTNpCnVQNXc1RjRRMnhJOVVXQnNlNVROM2FZNnpCaUNWSXhqamJINzlnYmJid2xqTk54eWc1VmhsdXNmcnJ2N2xFcmwKUlBmV1plZ2NhV1pxemNmV2h6UzFDZ3RLc2ppUXpCMFJOclQ1NkNwbFZ4dEMxcHdFdjBuRmdINTd2cWxGTURadAp0cThxNGhHYVZ1UWV2UTRWemRNbWF6N2JoUGRpRUd5c1ArMlZLdHp5eDRGbng1aDBTdklxZlhXSmVyaG04UkRKCmEyVmJxenRGaVZPN0FDUTA2L01sK0kweUpDNEx4Y2dZVDhtWVVXeDFVWVdsM0JUTzN5dUo3Y3FLcFFoVjVBUk0KejNZT2tUSEV5MWJVUWd6VEt4bVhIK0N3cWtrMnc3TmlTYTNCLzNPSFRva0Q2bm15eUFKSjhEWXdwRWp4dE5OSwpmc1AwSVpjYTJ2M1p2TlFWNEtMR3hwMWpheENEU3dJREFRQUJBb0lDQUVMUDR2M213Y25qd0NpSm1VTGd0WXpvCjRMS0FtajNYdjUyYkNXZDdqMEQ5Mmpjc1loTG1wNmJLUVZuRFAzbEl2dmsyMVViQ3BYOWZxL3p0RVdYTWV0aXkKaVMzYkVpNXA0UEtYNjlxNUFPYm1VUnlCcWIxTXlUSEMzU2ttVjV5bE5vSkQ1QUMwZEs4SDNON2FCSnJtc2t4ZQozUWxocmdOR3hPcXJHWUNMRVJrcVlGRFIxTkxVaDdWZGl3YWcwdXo5Mi90QUl6b0NBTEtib0dBMHFEdDFjTC9SCkUwVVYvVVo2RW5MNXZOSGxrTTl0NnNnWjNpamM0Y0xORWxNRzg0c09EcXRWVEpCbzhLWEVuZC85UDZ0VnZ3ZVEKUEFxay9GcDJvRm1xRXdvTkVKREdLcTJkaEs2UGZaaTFqRlZzdFVuM3hCZHBtRXYvSG0zUFp5Ny9jV0RZU1FQaApRZ0RCZXE0ODJnZllqUGZZSEI4ZVdIL2g3aCtaMzYzVUJ3bUNHYkFoNElMZk9QVWVYcmRCN1JQVGRUTkFIekx4CnU0S09SQ3FHRW5JWEhxTzFaaEJKSkdMMnBJa3lvVnFGVmFqeUkrTG5mUWIwa0c5U0Y5NTZMN0FBWjR2UlcybVYKL1ZZaFpIYkY5WWM1TllZem02dVlrd1pKRWVTblZsNC9xQ01QQ3B1eFl4aVd0ZW9NSGxOTDlaK0ZwaE9Pa2x0RwoxWUFyZWEvZ0t5Q2ZhZm1uZkZGNlJ0NnEvd0MxZlR0cGZjSzkzbjJxYmlrZkNSMG5CRHdXZmppN0tJcFVhbUZlCkdyQWJRdmo4eHk2SUNoVmdhVllXTEZhaGFmVDI2TWJvdWovaEhWTlZDanR4UmhoRms0SXFYcUJobndwbjV0aVUKbmw4dUVwRG1yTkU5emNsWFhqYUJBb0lCQVFEMm1NOVBROXFHMlRFajdWTTV3K3ZONXRkUXh2TktCY3JyWVpTcQpudHY1RGVhY21ESWR6eHZ3M0M2cnYvcE1yWXBMUkM1N2dDMXVSN1JreEQ1S09YMTVGK0orSXlGYnBiUjdrNG9TCmVZOUNzYjVnUW51K29CbXNaNGxoWldocnNaMy9CK2oxd01QNHRpdWxIOURXNjBtT2poREY2aFFmRE5MdlAxU24KQnBHWXNkUndoNHZNd1hHQWhmN051bFh4Wkc5VjBvdzRkY0lCUjF4dnZ6T2lqQXc3UllLdkk2RTVtdFJnL2gvSwp0dmk3endiSEl0STFwdWFBd1pBaUk5ck5wYjdUU2J6Z3hNQmhabUhrbUp3eFFWeGRMM1JQZFVQNGtiSUs4b0t2CjJPeW8rT1pwZHUxTDMzMHZETTZSUC8zNlB1ZUxzN1ZlMG1qNWZybDF3Vy9kSVRaQkFvSUJBUURLZko5aFpUUDcKNmdGdmlFdzk3cjFXclF4OVdUaVhCNW9vemVsZkJNTFpZNjBGSFJ4Q25sUmtqM3FOWkhDYXMwL0ZycGw5MkU1NApWREVzU2NPMUt0VzFTZjJqc2dSd2h3eTNvU1lNcEFtdkZ3TjRVcXYxOXRsb2U3TkkvUi90ZU1jaEdkS1BCTE1RCi9YMzV3bjhoMTFRdUFBNUduWkg2VjZaWnFYeHRJRTcyWGhtUllJVXpLb3RFdzdscWh3SGpEWXFwVVdtejY2dkQKOGIxTnRFb2tNUnBNYjZxZmhlbTQ3aElJVUx6dlZlSE9FSEdmRXlQMVdKTER6OGt4b21BaXlDNE8vcDRqSVlEawppdEFSUm1ZZCtkcnVQSWlpMzZSdmtnVnFjREZ2Qm4wNW41MVpMdnBwV1V5V3BNY2UxNzVoRkFZb1VBUm93R3lWCmJQZSttSkRSOEk2TEFvSUJBUURiYmh6REx1RHNyNlhQajJaSWQ3T0R0QThTL1FZT2Ixc2kydUVjZG1ITm0vWUMKa0ZmQU9NUm5McmFFOUQ2NUxvOXA3RkRrYXFtQ2dXSGZiTlQwM1hWdVpMZVJnSmMxWXgxWC9YQ1dnZjdkM1NaSApwOEZQWGsyYUlVT1pIRkN2ekF5SW5MUkt3bTVnQ1ZLTEMrV2M2Uis2TDJaemhwakRESGxDbFhzeGFXSHptd0lyCjVDR2RZT0VyK1pCRDVyU0ZLZGI4YW0rRjZodHBZZU82T0V5dExxdlBya25jcVByVk5KWVpmT2d6VFYvR1Z6RnoKeitONEJIMEdRN2VLK1piQStlVDFSSjlDN3pFMU9wS1BoTkV2N3paT1lXVEJNOXI0L0VTUEF6OFJWUms2UHNsaApQWWRveFlVeWNkWDZZQlFUTXhoOU1ydUlsZmo5VWl1YndqWlZjakZCQW9JQkFBODgrYkdXc0NiUklYS0hTMVdOCjFlbmo5QUNxNmp0VGN5S0cvSDBPR3F2SmVJZmQvUFoyZTl0bGdNK0xNMzR3NkZ2MEc5RUFxa2NiN3VkcVZiUVkKbVNTZmdOc0UxcGl4VVIrd25QQnVsOXY1VzJWK3N6bzdiWGtUZGhhVUZnY0ZBOWRWM2lhdEw5eWpkd3VJdTVDTQpaK1ZlVTdTMHZ2dWNCUVRTWUc3Rjg2dE93WlhUTWJMOERLY01JN1FFblB1OVZTWVEzbWVQNE1sS00valpESXRVCnRxbng3V0U3N3E3Z0c3Tk1nQ3R5eHg5KzFVNG5YcGxrSlFkZlo4QzRlNHVpalBUTDdKS3dQc2IwTzF4UmMvWGwKaTdoS0RlNVQ3a2dITVNrbGNGTHVwaFhrRVM5WS9iZFg1UStoTHVyL1NYQjgxVW5MVzhtV1VaV2RNYmZDTzRQUgpHcWtDZ2dFQkFKZ1NGNitPVVg0U01oYW5mK2Y5cUhQbnJ3MmxPQXJGQzFzc2tyUmhhMjRlK09SbnhsM1NHejhMCi93cmpRL3lPMDU5ZGYyVkpQcUdDck5tK0YrTHdablMxQmZSaFZDY0F3clhBSWIrdUJFV1d6YVhkNHQ4VTU5b08KNFNxQWxCRzZpaXJLMVdxZ3BEYmhQWiszTzh3cXlIYjBWSkNVVGNlQ21MWS9PekQ2bU94MjFuNG5yREtvbDVXegpIOXhlMkRBcjhZbXhpNnJsejJ6VjkyQ0tadHNVM2ZWeEdwZ2VBTXQ1YnNDczZubDNJRGh2N1R5SDhicTQxRHpRCjdhc3dxRGJHQ05BZnFvaEFrNitTM283cHJFejZkMUtIbVo4bmdYK2lLK29oaW5lNzFzTDVhUkxXejM3SUNTVGEKQlIwUXVyNVVOVVJHUmIwZm8wWklnZlBmc0JqVFNvcz0KLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLQo=

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-configmap-deployment
  labels:
    app: nginx-configmap
spec:
  replicas: 1
  selector:
    matchLabels:
      app: nginx-configmap
  template:
    metadata:
      labels:
        app: nginx-configmap
    spec:
      containers:
      - name: nginx
        image: nginx
        imagePullPolicy: IfNotPresent
        volumeMounts:
        - name: index-volume
          mountPath: /usr/share/nginx/html
      volumes:
      - name: index-volume
        configMap:
          name: nginx-index-configmap

---
apiVersion: v1
kind: Service
metadata:
  name: nginx-svc
spec:
  ports:
  - name: nginx-port
    port: 80
    protocol: TCP
    targetPort: 80
  selector:
    app: nginx-configmap

---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: nginx-ingress
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /  
spec:
  rules:
  - http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: nginx-svc
            port: 
              name: nginx-port
  tls:
  - hosts:
    - 10.129.0.30
    secretName: nginx-tls-secret
